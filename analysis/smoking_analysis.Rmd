---
title: "Smoking Analysis"
output: html_notebook
---

```{r}
# Load the library files
library(here)
library(tidyverse)
```

```{r}
# Load the cleaned data
smoking <- read_csv(here("clean_data/smoking.csv"))
```

```{r}
smoking_by_health_board <- smoking %>% 
  select(name,
         type,
         date_code,
         smokes,
         sex,
         age,
         sm_percent
  ) %>% 
  filter(type == "NHS Health Board")
```

```{r}
smoking %>% 
  filter(type == "Local Authority",
         date_code == "2013",
         age == "All",
         sex == "All",
         long_term_condition == "All",
         household_type == "All") %>% 
  ggplot() +
  aes(x = name, y = sm_percent, fill = smokes) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```


```{r}
# Smoking rates, per gender, over time, 

smoking_by_health_board %>%
    filter(age == "All",
           smokes == "Yes",
           sex != "All") %>%
  arrange(date_code) %>% 
  group_by(date_code, sex) %>% 
  summarise(current_smokers = sum(smokes == "Yes")) %>% 
  ggplot(aes(x = date_code, y = current_smokers, group = sex, colour = sex)) +
  geom_point() +
  geom_line()
```

